const Stripe=require("stripe");const stripe=Stripe(process.env.STRIPE_SECRET_KEY);exports.handler=async(event)=>{try{const body=JSON.parse(event.body);const session=await stripe.checkout.sessions.create({payment_method_types:["card"],mode:"payment",line_items:body.items.map(i=>({price_data:{currency:"usd",product_data:{name:i.title},unit_amount:Math.round(i.price*100)},quantity:i.quantity})),success_url:`${process.env.FRONTEND_URL}/order-success?session_id={CHECKOUT_SESSION_ID}`,cancel_url:`${process.env.FRONTEND_URL}/checkout`});return{statusCode:200,headers:{"Access-Control-Allow-Origin":"*"},body:JSON.stringify({url:session.url})};}catch(e){return{statusCode:500,body:JSON.stringify({error:"Stripe error"})}}};